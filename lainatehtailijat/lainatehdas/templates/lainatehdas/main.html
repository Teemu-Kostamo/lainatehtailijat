{% extends "lainatehdas/base.html" %}
{% load static %}

{% block title %}Välineet{% endblock %}

{% block content %}
<h1 style="font-size:200%">Välineet</h1>
<br>
{% if items_list %}
<ul>
    {% for item in items_list %}
            <li>
                <a href="{% url 'lainatehdas:detail' item.id %}">{{item}} - {{item.get_item_avail_display}}</a>
                <img src="{% static item.item_img %}" width="200" height="300">
            {% if item.item_avail == "Va" %}
                    <form method="POST" action="{% url 'lainatehdas:create_new_reservation' item.id %}">
                        {% csrf_token %}
                        <button class="bg-blue-500 text-white px-4 py-2 rounded-md">Varaa</button>
                    </form>
            {% elif item.item_avail == "Vr" %}
                {% for reservation in reservation_list %}
                    {% if reservation.date_returned == Null and reservation.user_id == request.user.id %}
                        <form method="POST" action="{% url 'lainatehdas:update_return_date' reservation.id reservation.item.id %}">
                            {% csrf_token %}
                            <button type= "submit" class="bg-green-500 text-white px-4 py-2 rounded-md">Palauta</button>
                        </form>
                    {% elif reservation.date_returned == Null and reservation.user_id != request.user.id %}
                    <button type= "submit" class="bg-gray-500 text-white px-4 py-2 rounded-md">{{item.get_item_avail_display}}</button>
                    {% endif %}
                {% endfor %}
            {% else %}
                <button type= "submit" class="bg-gray-500 text-white px-4 py-2 rounded-md">{{item.get_item_avail_display}}</button>
            {% endif %}
            </li>
            <br><br>
    {% endfor %}
</ul>
{% else %}
    <p>No items available</p>
{% endif %}
{% endblock %}